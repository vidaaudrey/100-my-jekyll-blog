<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      A Design Pattern Story in Swift – Chapter 9: Iterator(Sequence and Generator) &middot; Audrey Li's Personal Blog
    
  </title>

  <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
  <![endif]-->

  <link rel='stylesheet' href='http://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css'>

  <link rel="stylesheet" type="text/css" href="/assets/bootstrap/css/bootstrap-theme.css">
  <link rel="stylesheet" type="text/css" href="/assets/bootstrap/css/bootstrap.css">

 
  <!-- CSS -->
  <!-- build:css /assets/stylesheets/style.min.css -->
  <link rel="stylesheet" href="/assets/stylesheets/style.css">
  <!-- endbuild -->
  <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700|PT+Sans:400">
  <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=RobotoDraft:100,300,400|Roboto:300,300italic,400">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">

  <!-- Favicon -->
  <link rel="apple-touch-icon" sizes="57x57" href="/assets/images/favicons/apple-touch-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/assets/images/favicons/apple-touch-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/assets/images/favicons/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/assets/images/favicons/apple-touch-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/assets/images/favicons/apple-touch-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/assets/images/favicons/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/assets/images/favicons/apple-touch-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/assets/images/favicons/apple-touch-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/assets/images/favicons/apple-touch-icon-180x180.png">
  <link rel="icon" type="image/png" href="/assets/images/favicons/favicon-32x32.png" sizes="32x32">
  <link rel="icon" type="image/png" href="/assets/images/favicons/android-chrome-192x192.png" sizes="192x192">
  <link rel="icon" type="image/png" href="/assets/images/favicons/favicon-96x96.png" sizes="96x96">
  <link rel="icon" type="image/png" href="/assets/images/favicons/favicon-16x16.png" sizes="16x16">
  <link rel="manifest" href="/assets/images/favicons/manifest.json">
  <meta name="apple-mobile-web-app-title" content="Audrey's Blog">
  <meta name="application-name" content="Audrey's Blog">
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="msapplication-TileImage" content="/assets/images/favicons/mstile-144x144.png">
  <meta name="theme-color" content="#ffffff">

</head>

  
  <body>
    <nav id="push_sidebar">
    <ul>
      <li><a href="#">Home</a></li>
      <li><a href="#">Portfolio</a></li>
      <li><a href="#">Contact</a></li>
    </ul>
    
    <div class="social-icons">
        <img src="/assets/images/audrey-li.jpg" alt="Audrey's Photo" class="img-circle">

        <a href="https://github.com/vidaaudrey" title="Audrey's Github">
            <span class="fa-stack fa-lg">
              <i class="fa fa-circle fa-stack-2x"></i>
              <i class="fa fa-github fa-stack-1x fa-inverse"></i>
            </span>

        <a href="https://www.facebook.com/audreyauli" title="Audrey's Facebook">
            <span class="fa-stack fa-lg">
              <i class="fa fa-circle fa-stack-2x"></i>
              <i class="fa fa-facebook fa-stack-1x fa-inverse"></i>
            </span>
        </a>
    
        <a href="https://google.com/+AudreyLiSF" title="Audrey's Google Plus">
            <span class="fa-stack fa-lg">
              <i class="fa fa-circle fa-stack-2x"></i>
              <i class="fa fa-google-plus fa-stack-1x fa-inverse"></i>
            </span>
        </a>
        
        <a href="/assets/images/wechat.jpg" title="Audrey's Wechat">
            <span class="fa-stack fa-lg">
              <i class="fa fa-circle fa-stack-2x"></i>
              <i class="fa fa-weixin fa-stack-1x fa-inverse"></i>
            </span>
        </a>

    </div>

</nav>
    <div id="main-wrap">
      <header class="nav-down"  id="wrapper">
    <a class="navbar-brand" href="/"><img alt="Brand" src="/assets/images/normal/logo-dark-round.png"></a>

    <div class="container-fluid">
       <span class="nav_trigger"><span class="glyphicon glyphicon-menu-hamburger"></span></span>
    </div>
</header>
      

<div class="jumbotron text-center" style="background-image: url('/assets/wp-content/uploads/2015/07/ancient-food.jpg')">


  <div class="container">
    <a href="/" title="Home Page"><h1>Audrey Li</h1></a>
    <p>Javascript, Swift, Ruby, learning...</p>
  </div>
</div>
     
      <main class="row">
          <div class="col-md-8 col-md-offset-2 col-sm-10 col-sm-offset-1 col-xs-12 ">
              <div class="main-wrap">
               <div class="post">
  <h1 class="post-title">A Design Pattern Story in Swift – Chapter 9: Iterator(Sequence and Generator)</h1>
  <span class="post-date">04 Jul 2015</span>
  <p class="p1">
  <span class="s1"> There is a restaurant with two kinds of menus: one for their VIP guests and one for customers who just want average fastfood. The two menus are in different format and one waitress has to be able to process both menus, in a simple way.</span>
</p>

<blockquote>
<p class="p1">
  Iterator provides a way to access the elements of an aggregate object sequentially without exposing its underlying representation. <em> &#8212; HeadFirst</em>
</p>
</blockquote>

<div class="highlight"><pre><code class="language-swift" data-lang="swift">struct MenuItem: CustomStringConvertible{
    let name: String
    let price: Int
    let isVegetable: Bool
    var description: String {
        let vegi = isVegetable ? &quot;Vegi&quot; : &quot;&quot;
        return  &quot;\(name): (\(price)#) \(vegi) \n&quot;  }
}

//: helper protocols. Hashable and Equatable is necesary for storing MenuItem in a Set
extension MenuItem: Hashable, Equatable{
    var hashValue: Int {
        return name.hashValue ^ price.hashValue
    }
}
func ==(lhs:MenuItem, rhs:MenuItem) -&amp;gt; Bool {
    return lhs.name == rhs.name
}


protocol PrettyDescription: CustomStringConvertible {
    var prettyDescription: String { get }
}

//: provide default implementation to describe the elements of the sequence. As the PrettyDescription inherit CustomStringConvertible, we can safely downcast the sequence elements to CustomStringConvertible
extension PrettyDescription where Self: protocol &amp;lt;SequenceType&amp;gt; {
    var prettyDescription: String {
        var temStr = &quot;\nMenu Items:\n&quot;
        self.map{temStr += ($0 as! CustomStringConvertible).description} 
        return temStr
    }
}

//: how next element is generated from a MenuItem Array
struct MenuGeneratorFromArray: GeneratorType {
    let menuItems:[MenuItem]
    var index = 0
    mutating func next() -&amp;gt; MenuItem? {
        return index &amp;lt; menuItems.count ? menuItems[index++] : nil
    }
}

//: how next element is generated from a MenuItem Set
struct MenuGeneratorFromSet: GeneratorType {
    let menuItems:Set&amp;lt;MenuItem&amp;gt;
    var index = 0
    mutating func next() -&amp;gt; MenuItem? {
        return index &amp;lt; (menuItems.count) ? menuItems[advance(menuItems.startIndex, index++)] : nil
    }
}

//: The VIPMenu using Array
struct VIPMenu:SequenceType, PrettyDescription {
    var menuItems:[MenuItem] = []
    var description: String { return &quot;VIP Menu&quot; + prettyDescription }
    func generate() -&amp;gt; MenuGeneratorFromArray {
        return MenuGeneratorFromArray(menuItems: menuItems, index: 0)
    }
    func underestimateCount() -&amp;gt; Int { return menuItems.count }
    
    init(){
        addItem(&quot;Tiran Goose&quot;, price: 10)
        addItem(&quot;Fairy Cake&quot;, price: 13)
        addItem(&quot;Heaven Grass&quot;, price: 4, isVegetable: true)
        print(&quot;VIPMenu Created&quot;)
    }
    mutating func addItem(name: String, price: Int, isVegetable:Bool = false){
        let item = MenuItem(name: name, price: price, isVegetable: isVegetable)
        menuItems.append(item)
    }
}

//: The FastfoodMenu using Set
class FastfoodMenu: SequenceType, PrettyDescription {
    var menuItems = Set&amp;lt;MenuItem&amp;gt;()
    var description: String { return &quot;Fastfood Menu&quot; + prettyDescription }
    var nextIndex = -1
    func generate() -&amp;gt; MenuGeneratorFromSet {
        return MenuGeneratorFromSet(menuItems: menuItems, index: 0)
    }
    func underestimateCount() -&amp;gt; Int { return menuItems.count }
    
    init(){
        addItem(&quot;Cheese Cake&quot;, price: 10)
        addItem(&quot;Lettus&quot;, price: 4, isVegetable: true)
        addItem(&quot;Ham&quot;, price: 13)
        print(&quot;FastfoodMenu Created&quot;)
    }
    func addItem(name: String, price: Int, isVegetable:Bool = false){
        let item = MenuItem(name: name, price: price, isVegetable: isVegetable)
        menuItems.insert(item)
    }
}

//: Every waitress has two menus at hand and they can print the menus
class Waitress {
    let vipMenu: VIPMenu
    let fastfoodMenu: FastfoodMenu
    init(vipMenu: VIPMenu, fastfoodMenu: FastfoodMenu){
        self.vipMenu = vipMenu
        self.fastfoodMenu = fastfoodMenu
        print(&quot;Waitress with two menus created&quot;)
    }
    func printMenu() {
        print(&quot;\nWaitress is printing the menu&quot;)
        let menus:[CustomStringConvertible] = [vipMenu, fastfoodMenu]
        menus.map{print($0)}
    }
}


//:Testing
var vipMenu = VIPMenu()
var fastfoodMenu = FastfoodMenu()

let waitress = Waitress(vipMenu: vipMenu, fastfoodMenu: fastfoodMenu)
waitress.printMenu()</code></pre></div>

<p><a href="/assets/wp-content/uploads/2015/07/iterator.png"><img class="aligncenter size-full wp-image-1013" src="/assets/wp-content/uploads/2015/07/iterator.png" alt="iterator" width="238" height="249" /></a></p>

</div>

<div class="related">
  <h2>Related Posts</h2>
  <ul class="related-posts">
    
      <li>
        <h3>
          <a href="/2015/07/18/a-design-pattern-story-in-swift-chapter-21-interpretor/">
            A Design Pattern Story in Swift – Chapter 21: Interpretor
            <small>18 Jul 2015</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/2015/07/18/a-design-pattern-story-in-swift-chapter-20-mediator/">
            A Design Pattern Story in Swift – Chapter 20: Mediator
            <small>18 Jul 2015</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/2015/07/17/a-design-pattern-story-in-swift-chapter-19-flyweight/">
            A Design Pattern Story in Swift – Chapter 19: Flyweight
            <small>17 Jul 2015</small>
          </a>
        </h3>
      </li>
    
  </ul>
</div>

<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'audreyli';
    
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>


              </div>
          </div>
          
      </main>
    
     <footer class="row">
    <div class="col-md-8 col-md-offset-2 text-center">
        &copy Copyright 2015 &nbsp; &nbsp; AudreyLi.me &nbsp; &nbsp;<a href="mailto:me@audreyli.me">Get in touch</a>
    </div>
    
</footer>


     <!-- Latest compiled and minified JavaScript -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>

<!-- JS -->
<!-- build:js /assets/javascript/all.min.js -->
<script src="/assets/javascript/javascript.js"></script> 
<script src="/assets/javascript/main.js"></script> 
<!-- endbuild -->
  </div>
  </body>
</html>
