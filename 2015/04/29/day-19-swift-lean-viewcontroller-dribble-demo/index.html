<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      Day 19&#8230; Swift Lean ViewController &#8211;  Dribble Demo &middot; Audrey Li's Personal Blog
    
  </title>

  <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
  <![endif]-->

  <link rel='stylesheet' href='http://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css'>
  <link rel="stylesheet" type="text/css" href="/assets/bootstrap/css/bootstrap.css">
  <link rel="stylesheet" type="text/css" href="/assets/bootstrap/css/bootstrap-theme.css">


 
  <!-- CSS -->
  <!-- build:css /assets/stylesheets/style.min.css -->
  <link rel="stylesheet" href="/assets/stylesheets/style.css">
  <!-- endbuild -->
  
  <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=RobotoDraft:100,300,400|Roboto:300,300italic,400">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">

  <!-- Favicon -->
  <link rel="apple-touch-icon" sizes="57x57" href="/assets/images/favicons/apple-touch-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/assets/images/favicons/apple-touch-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/assets/images/favicons/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/assets/images/favicons/apple-touch-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/assets/images/favicons/apple-touch-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/assets/images/favicons/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/assets/images/favicons/apple-touch-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/assets/images/favicons/apple-touch-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/assets/images/favicons/apple-touch-icon-180x180.png">
  <link rel="icon" type="image/png" href="/assets/images/favicons/favicon-32x32.png" sizes="32x32">
  <link rel="icon" type="image/png" href="/assets/images/favicons/android-chrome-192x192.png" sizes="192x192">
  <link rel="icon" type="image/png" href="/assets/images/favicons/favicon-96x96.png" sizes="96x96">
  <link rel="icon" type="image/png" href="/assets/images/favicons/favicon-16x16.png" sizes="16x16">
  <link rel="manifest" href="/assets/images/favicons/manifest.json">
  <meta name="apple-mobile-web-app-title" content="Audrey's Blog">
  <meta name="application-name" content="Audrey's Blog">
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="msapplication-TileImage" content="/assets/images/favicons/mstile-144x144.png">
  <meta name="theme-color" content="#ffffff">

</head>

  
  <body>
    <nav id="push_sidebar">
    <div class="social-icons">
        <img src="/assets/images/audrey-li.jpg" alt="Audrey's Photo" class="img-circle">

        <a href="https://github.com/vidaaudrey" title="Audrey's Github">
            <span class="fa-stack fa-lg">
              <i class="fa fa-circle fa-stack-2x"></i>
              <i class="fa fa-github fa-stack-1x fa-inverse"></i>
            </span>
        </a>
        <a href="https://www.facebook.com/audreyauli" title="Audrey's Facebook">
            <span class="fa-stack fa-lg">
              <i class="fa fa-circle fa-stack-2x"></i>
              <i class="fa fa-facebook fa-stack-1x fa-inverse"></i>
            </span>
        </a>

        <a href="https://www.linkedin.com/in/audreyauli" title="Audrey's Google Plus">
            <span class="fa-stack fa-lg">
              <i class="fa fa-circle fa-stack-2x"></i>
              <i class="fa fa-linkedin fa-stack-1x fa-inverse"></i>
            </span>
        </a>
        
        <a href="/assets/images/wechat.jpg" title="Audrey's Wechat">
            <span class="fa-stack fa-lg">
              <i class="fa fa-circle fa-stack-2x"></i>
              <i class="fa fa-weixin fa-stack-1x fa-inverse"></i>
            </span>
        </a>

    </div>

    <ul>
      <li><a href="/">Home</a></li>
      <li><a href="/portfolio">Portfolio</a></li>
      <li><a href="/archive">Archive</a></li>
      <li><a href="/atom.xml">Feed</a></li>
      <li><a href="/about">About</a></li>
    </ul>
</nav>

    <div id="body-wrap">
      <header class="nav-down"  id="wrapper">
    <div class="container-fluid">
       <a class="navbar-brand" href="/"><img alt="Brand" src="/assets/images/normal/logo-dark-round.png"></a>
       <span class="nav_trigger"><span class="glyphicon glyphicon-menu-hamburger"></span></span>
    </div>
</header>
      

<!-- jumbotron for pages -->

<!-- jumbotron for post page, with feature image -->
  
     <div class="jumbotron jumbotron-post-long-feature" style="background-image: url('/assets/images/wp-content/uploads/2015/04/snapshot8.png')">
         <div class="fullwidth-wrapper">
    <div class="col-md-8 col-md-offset-2 col-sm-10 col-sm-offset-1 col-xs-12 ">
      <div class="main-wrap">
           <h2 class="post-title">Day 19&#8230; Swift Lean ViewController &#8211;  Dribble Demo</h2>
            <p class="post-date">29 Apr 2015</p>
      </div>
    </div>
</div>
      </div>

  <!-- jumbotron for post page, without feature image -->
  






      <main class="row">
          <div class="col-md-8 col-md-offset-2 col-sm-10 col-sm-offset-1 col-xs-12 ">
              <div class="main-wrap">
                <div class="post card post-content">
   <p>
  <span>Description: an experiment on how to separate the viewController from tableViewDataSource while at the same time reduce the tableView interaction code. </span><a href="https://github.com/vidaaudrey/019-Swift-Lean-ViewController-Dribble-Demo" target="_blank">Source Code</a>
</p>

<p>
  <a href="/assets/images/wp-content/uploads/2015/04/snapshot6.gif"><img class=" size-full wp-image-800 aligncenter" src="/assets/images/wp-content/uploads/2015/04/snapshot6.gif" alt="snapshot" width="375" height="683" /></a>
</p>

<p>I started out with the wish to write a rounded UIView extension, which was quite easy to achieve. Somehow along the way I decided to revisit the previous Dribble code and make some improvement:</p>

<p>&#8211; a separate TableView DataSource handles the data manipulation and give feedback to the main ViewController when the user interaction is performed. The ViewController can then perform the corresponding view updates or other actions. In fact, almost all actions that triggered by user interaction can use the same function to call back the main ViewController:</p>

<div class="highlight"><pre><code class="language-swift" data-lang="swift"><span class="k">func</span> <span class="nf">tableViewCellActionHandler</span><span class="p">(</span><span class="nl">item</span><span class="p">:</span> <span class="n">AnyObject</span><span class="p">,</span> <span class="nl">indexPath</span><span class="p">:</span> <span class="bp">NSIndexPath</span><span class="p">,</span> <span class="nl">action</span><span class="p">:</span> <span class="n">TableViewActionType</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">switch</span> <span class="n">action</span> <span class="p">{</span>
        <span class="k">case</span> <span class="p">.</span><span class="nl">Edit</span><span class="p">:</span>
            <span class="n">println</span><span class="p">(</span><span class="s">&quot;editing&quot;</span><span class="p">)</span>
        <span class="k">case</span> <span class="p">.</span><span class="nl">Favoriate</span><span class="p">:</span>
            <span class="n">favShots</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span> <span class="kt">as</span><span class="o">!</span> <span class="n">Shot</span><span class="p">)</span>
            <span class="n">println</span><span class="p">(</span><span class="s">&quot;faved&quot;</span><span class="p">)</span>
            <span class="n">tableView</span><span class="p">.</span><span class="n">setEditing</span><span class="p">(</span><span class="nb">false</span><span class="p">,</span> <span class="nl">animated</span><span class="p">:</span> <span class="nb">true</span><span class="p">)</span>
        <span class="k">case</span> <span class="p">.</span><span class="nl">Save</span><span class="p">:</span>
            <span class="k">if</span> <span class="k">let</span> <span class="n">cell</span> <span class="o">=</span> <span class="n">tableView</span><span class="p">.</span><span class="n">cellForRowAtIndexPath</span><span class="p">(</span><span class="n">indexPath</span><span class="p">)</span> <span class="kt">as</span><span class="o">?</span> <span class="n">ShotTableViewCell</span> <span class="p">{</span>
                <span class="k">if</span> <span class="k">let</span> <span class="n">image</span> <span class="o">=</span> <span class="n">cell</span><span class="p">.</span><span class="n">shotImageView</span><span class="o">?</span><span class="p">.</span><span class="n">image</span> <span class="p">{</span>
                    <span class="n">Utils</span><span class="p">.</span><span class="n">saveImageToLibrary</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
                    <span class="n">tableView</span><span class="p">.</span><span class="n">setEditing</span><span class="p">(</span><span class="nb">false</span><span class="p">,</span> <span class="nl">animated</span><span class="p">:</span> <span class="nb">true</span><span class="p">)</span> <span class="c1">// imp</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="k">case</span> <span class="p">.</span><span class="nl">DidSelect</span><span class="p">:</span>
            <span class="n">println</span><span class="p">(</span><span class="s">&quot;selecting \(indexPath.row)&quot;</span><span class="p">)</span>
        <span class="k">case</span> <span class="p">.</span><span class="nl">DidDeselect</span><span class="p">:</span>
           <span class="n">tableView</span><span class="p">.</span><span class="n">deselectRowAtIndexPath</span><span class="p">(</span><span class="n">indexPath</span><span class="p">,</span> <span class="nl">animated</span><span class="p">:</span> <span class="nb">true</span><span class="p">)</span> <span class="c1">// call it to make sure it does deselect. (Sometime, it doesn&#39;t)</span>
           <span class="n">println</span><span class="p">(</span><span class="s">&quot;deselected \(indexPath.row)&quot;</span><span class="p">)</span>

        <span class="k">case</span> <span class="p">.</span><span class="nl">Delete</span><span class="p">:</span>
            <span class="n">shots</span><span class="p">.</span><span class="n">removeAtIndex</span><span class="p">(</span><span class="n">indexPath</span><span class="p">.</span><span class="n">row</span><span class="p">)</span>
        <span class="k">case</span> <span class="p">.</span><span class="nl">More</span><span class="p">:</span>
            <span class="n">println</span><span class="p">(</span><span class="s">&quot;More&quot;</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span></code></pre></div>

<p>The TableView Action types are custom defined:</p>

<div class="highlight"><pre><code class="language-swift" data-lang="swift"><span class="n">public</span> <span class="k">enum</span> <span class="nl">TableViewActionType</span><span class="p">:</span> <span class="n">String</span> <span class="p">{</span>
    <span class="k">case</span> <span class="n">Edit</span>  <span class="o">=</span> <span class="s">&quot;Edit&quot;</span>
    <span class="k">case</span> <span class="n">Save</span> <span class="o">=</span> <span class="s">&quot;Save&quot;</span>
    <span class="k">case</span> <span class="n">More</span> <span class="o">=</span> <span class="s">&quot;More&quot;</span>
    <span class="k">case</span> <span class="n">Favoriate</span> <span class="o">=</span> <span class="s">&quot;Favoriate&quot;</span>
    <span class="k">case</span> <span class="n">Delete</span> <span class="o">=</span> <span class="s">&quot;Delete&quot;</span>
    <span class="k">case</span> <span class="n">DidSelect</span> <span class="o">=</span> <span class="s">&quot;DidSelect&quot;</span>
    <span class="k">case</span> <span class="n">DidDeselect</span> <span class="o">=</span> <span class="s">&quot;DidDeselect&quot;</span>
<span class="p">}</span></code></pre></div>

<p>&nbsp;</p>

<p>The rounded UIView extension which can be called easily with:  <span>userImageView</span><span>.</span><span>round</span><span>()</span></p>

<div class="highlight"><pre><code class="language-swift" data-lang="swift"><span class="n">public</span> <span class="k">extension</span> <span class="bp">UIView</span> <span class="p">{</span>
        <span class="n">public</span> <span class="k">func</span> <span class="n">round</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">let</span> <span class="n">width</span> <span class="o">=</span> <span class="n">bounds</span><span class="p">.</span><span class="n">width</span> <span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span> <span class="n">bounds</span><span class="p">.</span><span class="n">height</span> <span class="o">?</span> <span class="n">bounds</span><span class="p">.</span><span class="nl">width</span> <span class="p">:</span> <span class="n">bounds</span><span class="p">.</span><span class="n">height</span>
        <span class="k">let</span> <span class="n">mask</span> <span class="o">=</span> <span class="bp">CAShapeLayer</span><span class="p">()</span>
        <span class="n">mask</span><span class="p">.</span><span class="n">path</span> <span class="o">=</span> <span class="bp">UIBezierPath</span><span class="p">(</span><span class="nl">ovalInRect</span><span class="p">:</span> <span class="n">bounds</span><span class="p">.</span><span class="n">rectByCentering</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="nl">height</span><span class="p">:</span> <span class="n">width</span><span class="p">)).</span><span class="bp">CGPath</span>
        <span class="nb">self</span><span class="p">.</span><span class="n">layer</span><span class="p">.</span><span class="n">mask</span> <span class="o">=</span> <span class="n">mask</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre></div>

 </div>
 <div class="card">
   <div class="page-nav">
    <div>
        
         <a class="prev" href="/2015/04/29/018-swift-currency-converter/"> <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span></a> 
          <a class="prev" href="/2015/04/29/018-swift-currency-converter/"> Day 18 - Swift Currency Converter</a>
        
    </div>
    <div>
        
          <a class="next" href="/2015/05/02/day-020-swift-color-picker/">Day 20 &#8211; Swift Color Picker </a>
         <a class="prev" href="/2015/05/02/day-020-swift-color-picker/"> <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> 
        
    </div>
</div>



 </div>
 <div class="related card">
   <h2>Related Posts</h2>
   <ul class="related-posts">
     
       <li>
         <h4>
           <a href="/general/2015/11/11/singles-day/">
             Singles Day
             <small>11 Nov 2015</small>
           </a>
         </h4>
       </li>
     
       <li>
         <h4>
           <a href="/css/js/2015/09/28/js-image-zoom/">
             Create Image Zoom Style Like Medium
             <small>28 Sep 2015</small>
           </a>
         </h4>
       </li>
     
       <li>
         <h4>
           <a href="/jekyll/2015/09/27/relocating-my-blog-from-wordpress-to-Jekyll/">
             Relocating My Blog from Wordpress to Jekyll
             <small>27 Sep 2015</small>
           </a>
         </h4>
       </li>
     
   </ul>
 </div>
 <div class="card">
 <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'audreyli';
    
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
 </div>
      
    




              </div>
          </div>
          
      </main>

      <footer class="row">
    <div class="col-md-8 col-md-offset-2 text-center">
        &copy; Copyright 2015 &nbsp; &nbsp; AudreyLi.me &nbsp; &nbsp;<a href="mailto:me@audreyli.me">Get in touch</a>
    </div>
    
</footer>


      
<!-- Latest compiled and minified JavaScript -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>

<script type="text/javascript" src="http://terrymun.github.io/Fluidbox/jquery.fluidbox.min.js"></script>
<<script src="/assets/javascript/jquery.shuffle.modernizr.js"></script>
<!-- JS -->
<!-- build:js /assets/javascript/all.min.js -->
<script src="/assets/javascript/javascript.js"></script> 
<script src="/assets/javascript/main.js"></script> 
<!-- endbuild -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga (http://www.google-analytics.com/analytics.js','ga)');

ga('create', 'UA-68084914-1', 'auto');
ga('send', 'pageview');

</script>

  </div>
  </body>
</html>
